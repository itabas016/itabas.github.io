<!DOCTYPE html>
<html lang="en">
  <head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="Oracle - Database Structure"><meta name="keywords" content="Oracle, KT, 个人记录 | Technology"><link rel="alternate" href="/atom.xml" title="个人记录 | Technology"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.0">
<link rel="canonical" href="https://ebanbox.com/2016/10/14/database/oracle-kt-database-structure/">

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css">
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0">

<script id="baidu_analytics">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?55dddc0bcf5586602b667550911fde04";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-50282295-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-50282295-4');
</script><script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script src="//cdn1.lncld.net/static/js/3.1.1/av-min.js"></script>
  <script id="leancloud">
    AV.init({
      appId: "CoEy126Hk5NBPaVCgahS7P0p-gzGzoHsz",
      appKey: "Sd1OLyWqAE53kPjgBvFXuaCJ"
    });
  </script><script>
  window.config = {"leancloud":{"app_id":"CoEy126Hk5NBPaVCgahS7P0p-gzGzoHsz","app_key":"Sd1OLyWqAE53kPjgBvFXuaCJ"},"toc":true,"fancybox":true,"pjax":"","latex":false};
</script>

    <title>Oracle - Database Structure - 个人记录 | Technology</title>
  <link rel="alternate" href="/atom.xml" title="个人记录 | Technology" type="application/atom+xml">
</head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">个人记录 | Technology</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">Home
          </li>
      </a><a href="/archives/">
        <li class="mobile-menu-item">Archives
          </li>
      </a><a href="/tags">
        <li class="mobile-menu-item">Tags
          </li>
      </a><a href="/about">
        <li class="mobile-menu-item">About
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">个人记录 | Technology</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            Home
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            Archives
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            Tags
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/about">
            About
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><article class="post">
    <header class="post-header">
      <h1 class="post-title">Oracle - Database Structure
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-10-14
        </span><span class="post-category">
            <a href="/categories/Database/">Database</a>
            </span>
        <span class="post-visits" data-url="/2016/10/14/database/oracle-kt-database-structure/" data-title="Oracle - Database Structure">
          Visits 0
        </span>
        </div>
    </header>

    <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">Contents</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tablespace-amp-Datafile"><span class="toc-text">Tablespace &amp; Datafile</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Select-database-free-space"><span class="toc-text">Select database free space</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#How-to-Allocate-More-Space-for-a-Database"><span class="toc-text">How to Allocate More Space for a Database</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Add-a-datafile-to-a-tablespace"><span class="toc-text">Add a datafile to a tablespace</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Add-a-new-tablespace"><span class="toc-text">Add a new tablespace</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Increase-the-size-of-a-datafile"><span class="toc-text">Increase the size of a datafile</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Database-Blocks-Extents-Segments"><span class="toc-text">Database Blocks, Extents, Segments</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Data-Block"><span class="toc-text">Data Block</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Extents"><span class="toc-text">Extents</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Segments"><span class="toc-text">Segments</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Tablespaces"><span class="toc-text">Tablespaces</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Database-Schema-Objects"><span class="toc-text">Database Schema Objects</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Tables"><span class="toc-text">Tables</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Views"><span class="toc-text">Views</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Materialized-Views"><span class="toc-text">Materialized Views</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Indexes"><span class="toc-text">Indexes</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Sequence"><span class="toc-text">Sequence</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Synonyms"><span class="toc-text">Synonyms</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Constraints"><span class="toc-text">Constraints</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#PRIMARY-KEY-CONSTRAINT"><span class="toc-text">PRIMARY KEY CONSTRAINT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#UNIQUE-CONSTRAINT"><span class="toc-text">UNIQUE CONSTRAINT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#FOREIGN-KEY-CONSTRAINT"><span class="toc-text">FOREIGN KEY CONSTRAINT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#NOT-NULL-CONSTRAINT"><span class="toc-text">NOT NULL CONSTRAINT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CHECK-CONSTRAINT"><span class="toc-text">CHECK CONSTRAINT</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Tiggers"><span class="toc-text">Tiggers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Clusters"><span class="toc-text">Clusters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Database-links"><span class="toc-text">Database links</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Database-logs"><span class="toc-text">Database logs</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Redo-logs"><span class="toc-text">Redo logs</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#How-to-detect"><span class="toc-text">How to detect</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Archive-logs"><span class="toc-text">Archive logs</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#How-to-detect-archive-mode"><span class="toc-text">How to detect archive mode:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#How-to-enable-disable-archive"><span class="toc-text">How to enable / disable archive</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Undo-logs"><span class="toc-text">Undo logs</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#How-to-detect-1"><span class="toc-text">How to detect</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Logs-and-Directories"><span class="toc-text">Logs and Directories</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#How-to-detect-log-in-sql-statement"><span class="toc-text">How to detect log in sql statement</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#How-to-list-oracle-directories"><span class="toc-text">How to list oracle directories</span></a></li></ol></li></ol></li></ol>
    </div>
  </div><div class="post-content"><blockquote>
<p>Total four parts, <code>Tablespaces, Datafiles</code>, <code>Database Blocks, Extents, Segments</code>, <code>Database Schema Objects</code> and <code>Database Logs</code></p>
</blockquote>
<a id="more"></a>

<h3 id="Tablespace-amp-Datafile"><a href="#Tablespace-amp-Datafile" class="headerlink" title="Tablespace &amp; Datafile"></a>Tablespace &amp; Datafile</h3><blockquote>
<p>Oracle Database stores logically in <code>tablespaces</code> and physically in <code>datadfiles</code> associated with the corresponding tablespace.<br><img src="/../../../ref/oracle-tablespace-datafile.gif" alt="tablespaces-datafiles"></p>
</blockquote>
<h4 id="Select-database-free-space"><a href="#Select-database-free-space" class="headerlink" title="Select database free space"></a>Select database free space</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> tablespace_name,file_id,block_id,<span class="keyword">bytes</span>,blocks <span class="keyword">from</span> dba_free_space;</span><br></pre></td></tr></table></figure>

<h4 id="How-to-Allocate-More-Space-for-a-Database"><a href="#How-to-Allocate-More-Space-for-a-Database" class="headerlink" title="How to Allocate More Space for a Database"></a>How to Allocate More Space for a Database</h4><blockquote>
<p>Enlarge a database in three ways: </p>
</blockquote>
<h5 id="Add-a-datafile-to-a-tablespace"><a href="#Add-a-datafile-to-a-tablespace" class="headerlink" title="Add a datafile to a tablespace"></a>Add a datafile to a tablespace</h5><blockquote>
<p><img src="/../../../ref/oracle-add-datafile-to-tbs.gif" alt="datafile"></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- add new datafile</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">tablespace</span> app_data <span class="keyword">add</span> <span class="keyword">datafile</span></span><br><span class="line"><span class="string">'/oracle-datafile-path/app03.dbf'</span> <span class="keyword">size</span> <span class="number">50</span>m;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- add new datafile and autoextend datafile</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">tablespace</span> app_data <span class="keyword">add</span> <span class="keyword">datafile</span></span><br><span class="line"><span class="string">'/oracle-datafile-path/app04.dbf'</span> <span class="keyword">size</span> <span class="number">50</span>m</span><br><span class="line"><span class="keyword">autoextend</span> <span class="keyword">on</span> <span class="keyword">next</span> <span class="number">5</span>m <span class="keyword">maxsize</span> <span class="number">100</span>m;</span><br></pre></td></tr></table></figure>

<h5 id="Add-a-new-tablespace"><a href="#Add-a-new-tablespace" class="headerlink" title="Add a new tablespace"></a>Add a new tablespace</h5><blockquote>
<p><img src="/../../../ref/oracle-add-new-tbs.gif" alt="tbs"></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- create new tablespace and using disk space auto mamagement</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">tablespace</span> <span class="string">"app_data02"</span> </span><br><span class="line"><span class="keyword">logging</span></span><br><span class="line"><span class="keyword">datafile</span> <span class="string">'/oracle-datafile-path/app02.ora'</span> <span class="keyword">size</span> <span class="number">5</span>m</span><br><span class="line"><span class="keyword">extent</span>    <span class="keyword">management</span> <span class="keyword">local</span> <span class="keyword">segment</span> <span class="keyword">space</span> <span class="keyword">management</span> <span class="keyword">auto</span></span><br></pre></td></tr></table></figure>

<h5 id="Increase-the-size-of-a-datafile"><a href="#Increase-the-size-of-a-datafile" class="headerlink" title="Increase the size of a datafile"></a>Increase the size of a datafile</h5><blockquote>
<p><img src="/../../../ref/oracle-increase-datafile-size.gif" alt="increase-size"></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- allow already exisit datafile autoextend</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">database</span> <span class="keyword">datafile</span> <span class="string">'/oracle-datafile-path/app03.dbf'</span></span><br><span class="line"><span class="keyword">autoextend</span> <span class="keyword">on</span> <span class="keyword">next</span> <span class="number">5</span>m <span class="keyword">maxsize</span> <span class="number">100</span>m;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- manually resize already exisit datafile</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">database</span> <span class="keyword">datafile</span> <span class="string">'/oracle-datafile-path/app02.dbf'</span></span><br><span class="line"><span class="keyword">resize</span> <span class="number">100</span>m;</span><br></pre></td></tr></table></figure>

<h3 id="Database-Blocks-Extents-Segments"><a href="#Database-Blocks-Extents-Segments" class="headerlink" title="Database Blocks, Extents, Segments"></a>Database Blocks, Extents, Segments</h3><blockquote>
<p>From logical side to divide, <code>Blocks &lt; Extents &lt; Segments &lt; Tablespaces</code><br><img src="/../../../ref/oracle-structure.jpg" alt="structure"></p>
</blockquote>
<h4 id="Data-Block"><a href="#Data-Block" class="headerlink" title="Data Block"></a>Data Block</h4><blockquote>
<p>Oracle Database manages the storage space in the datafiles of a database in units called <strong><code>data blocks</code></strong>. A data block is the smallest unit of data used by a database. In contrast, at the physical, operating system level, all data is stored in bytes. Each operating system has a <code>block size</code>. Oracle Database requests data in multiples of Oracle Database data blocks, not operating system blocks.</p>
</blockquote>
<blockquote>
<p>The standard block size is specified by the <code>DB_BLOCK_SIZE</code> initialization parameter, default value is <code>8192 bytes</code>.</p>
</blockquote>
<h4 id="Extents"><a href="#Extents" class="headerlink" title="Extents"></a>Extents</h4><blockquote>
<p>An <code>extent</code> is a logical unit of database storage space allocation made up of a number of contiguous data blocks. One or more extents in turn make up a <code>segment</code>. When the existing space in a segment is completely used, Oracle Database allocates <code>a new extent</code> for the <code>segment</code>.</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Related system tables: `DBA_EXTENTS`, `USER_EXTENTS`.</span><br></pre></td></tr></table></figure>

<h4 id="Segments"><a href="#Segments" class="headerlink" title="Segments"></a>Segments</h4><blockquote>
<p>A <code>segment</code> is a set of extents that contains all the data for a specific logical storage structure within a tablespace. For example, for each table, Oracle Database allocates one or more extents to form that table’s data segment, and for each index, Oracle Database allocates one or more extents to form its index segment.<br>Inculde the specific data objects: <code>Table</code>, <code>Index</code>, <code>Cluster Table</code>, and <code>user segments</code>, <code>undo segments</code> and all the types <code>segements</code>.</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Related system tables: `DBA_SEGMENTS`, `USER_SEGMENTS`.</span><br></pre></td></tr></table></figure>

<h4 id="Tablespaces"><a href="#Tablespaces" class="headerlink" title="Tablespaces"></a>Tablespaces</h4><blockquote>
<p>A database is divided into one or more logical storage units called <strong><code>tablespaces</code></strong>. Tablespaces are divided into logical units of storage called <code>segments</code>, which are further divided into <code>extents</code>. Extents are a collection of contiguous <code>blocks</code>.</p>
</blockquote>
<blockquote>
<p>When create default tablespace, contains <code>SYSTEM TABLESPACE</code>, <code>SYSAUX TABLESPACE</code>, <code>UNDO TABLESPACE</code>, <code>USERS TABLESPACE</code> and <code>TEMP TABLESPACE</code>.</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Related views: `V$TABLESPACE`, `V$DATAFILE`, `V$TEMPFILE`.</span><br></pre></td></tr></table></figure>

<h3 id="Database-Schema-Objects"><a href="#Database-Schema-Objects" class="headerlink" title="Database Schema Objects"></a>Database Schema Objects</h3><blockquote>
<p>A <code>schema</code> is a collection of logical structures of data, or schema objects. A <code>schema</code> is owned by a database user and has the same name as that user. Each user owns a single schema. Schema objects can be created and manipulated with SQL and include the following types of objects:</p>
</blockquote>
<blockquote>
<p><strong><code>Tables</code></strong>, <strong><code>Views</code></strong>, <strong><code>Materialized Views</code></strong>, <strong><code>Indexes</code></strong>, <strong><code>Sequence</code></strong>, <strong><code>Synonyms</code></strong>, <strong><code>Clusters</code></strong>, <strong><code>Constraints</code></strong>, <strong><code>Tiggers</code></strong>, <strong><code>Database links</code></strong></p>
</blockquote>
<h4 id="Tables"><a href="#Tables" class="headerlink" title="Tables"></a>Tables</h4><blockquote>
<p>Tables is very basic and simple. You know how to operate table <code>CURD</code>, and tables row, column, etc. Certainly, Tables has a lot of others properties, and divide <code>Partitioned Tables</code>, <code>Nested Tables</code>, <code>Temporary Tables</code>. etc.</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- create table</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line">( </span><br><span class="line">  column1 datatype [ <span class="literal">NULL</span> | <span class="keyword">NOT</span> <span class="literal">NULL</span> ],</span><br><span class="line">  ...</span><br><span class="line">  column_n datatype [ <span class="literal">NULL</span> | <span class="keyword">NOT</span> <span class="literal">NULL</span> ]</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- create as</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> new_table</span><br><span class="line">  <span class="keyword">AS</span> (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> old_table);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- primary key - create / alter / drop / enable</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line">(</span><br><span class="line">  column1 datatype <span class="literal">null</span>/<span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> constraint_name PRIMARY <span class="keyword">KEY</span> (column1)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> constraint_name PRIMARY <span class="keyword">KEY</span> (column1, column2, ... column_n);</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line"><span class="keyword">DISABLE</span> <span class="keyword">CONSTRAINT</span> constraint_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line"><span class="keyword">ENABLE</span> <span class="keyword">CONSTRAINT</span> constraint_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- alter table - multiple / modify / dorp column / rename</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line">  <span class="keyword">ADD</span> column_name <span class="keyword">column</span>-definition;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line">  <span class="keyword">MODIFY</span> column_name column_type;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line">  <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> column_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line">  <span class="keyword">RENAME</span> <span class="keyword">TO</span> new_table_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- drop table</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> [schema_name].table_name</span><br><span class="line">[ <span class="keyword">CASCADE</span> <span class="keyword">CONSTRAINTS</span> ]</span><br><span class="line">[ <span class="keyword">PURGE</span> ];</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28318/schema.htm#CNCPT211" target="_blank" rel="noopener">Tables Overview click here</a><br><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28310/tables.htm#i1008063" target="_blank" rel="noopener">Tables Manage click here</a></p>
</blockquote>
<h4 id="Views"><a href="#Views" class="headerlink" title="Views"></a>Views</h4><blockquote>
<p>It’s a virtual table that doesn’t physically exist, rather it’s created by a query joining one or more other tables.</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- create view</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> view_name <span class="keyword">AS</span></span><br><span class="line">  <span class="keyword">SELECT</span> <span class="keyword">columns</span></span><br><span class="line">  <span class="keyword">FROM</span> <span class="keyword">tables</span></span><br><span class="line">  [<span class="keyword">WHERE</span> conditions];</span><br><span class="line"></span><br><span class="line"><span class="comment">-- update view</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> <span class="keyword">REPLACE</span> <span class="keyword">VIEW</span> view_name <span class="keyword">AS</span></span><br><span class="line">  <span class="keyword">SELECT</span> <span class="keyword">columns</span></span><br><span class="line">  <span class="keyword">FROM</span> <span class="keyword">table</span></span><br><span class="line">  <span class="keyword">WHERE</span> conditions;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- drop view</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> view_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- dml statements and join views - same as table operation</span></span><br><span class="line"><span class="keyword">UPDATE</span> emp_dept</span><br><span class="line">     <span class="keyword">SET</span> loc = <span class="string">'BOSTON'</span></span><br><span class="line">     <span class="keyword">WHERE</span> ename = <span class="string">'SMITH'</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28318/schema.htm#CNCPT311" target="_blank" rel="noopener">Views Overview click here</a><br><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28310/views001.htm#ADMIN11774" target="_blank" rel="noopener">Views Manage click here</a></p>
</blockquote>
<h4 id="Materialized-Views"><a href="#Materialized-Views" class="headerlink" title="Materialized Views"></a>Materialized Views</h4><blockquote>
<p><code>Materialized views</code> are schema objects that can be used to summarize, compute, replicate, and distribute data. They are suitable in various computing environments such as data warehousing, decision support, and distributed or mobile computing:</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Creating Materialized Aggregate Views</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">MATERIALIZED</span> <span class="keyword">VIEW</span> <span class="keyword">LOG</span> <span class="keyword">ON</span> times</span><br><span class="line">   <span class="keyword">WITH</span> <span class="keyword">ROWID</span>, <span class="keyword">SEQUENCE</span> (time_id, calendar_year)</span><br><span class="line">   <span class="keyword">INCLUDING</span> <span class="keyword">NEW</span> <span class="keyword">VALUES</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">MATERIALIZED</span> <span class="keyword">VIEW</span> <span class="keyword">LOG</span> <span class="keyword">ON</span> products</span><br><span class="line">   <span class="keyword">WITH</span> <span class="keyword">ROWID</span>, <span class="keyword">SEQUENCE</span> (prod_id)</span><br><span class="line">   <span class="keyword">INCLUDING</span> <span class="keyword">NEW</span> <span class="keyword">VALUES</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">MATERIALIZED</span> <span class="keyword">VIEW</span> sales_mv</span><br><span class="line">   <span class="keyword">BUILD</span> <span class="keyword">IMMEDIATE</span></span><br><span class="line">   <span class="keyword">REFRESH</span> <span class="keyword">FAST</span> <span class="keyword">ON</span> <span class="keyword">COMMIT</span></span><br><span class="line">   <span class="keyword">AS</span> <span class="keyword">SELECT</span> t.calendar_year, p.prod_id, </span><br><span class="line">      <span class="keyword">SUM</span>(s.amount_sold) <span class="keyword">AS</span> sum_sales</span><br><span class="line">      <span class="keyword">FROM</span> times t, products p, sales s</span><br><span class="line">      <span class="keyword">WHERE</span> t.time_id = s.time_id <span class="keyword">AND</span> p.prod_id = s.prod_id</span><br><span class="line">      <span class="keyword">GROUP</span> <span class="keyword">BY</span> t.calendar_year, p.prod_id;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>And the detail usage will talk about in the later article~<br><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28318/schema.htm#CNCPT411" target="_blank" rel="noopener">Materialized Views Overview click here</a><br><a href="https://docs.oracle.com/cd/B19306_01/server.102/b14200/statements_6002.htm" target="_blank" rel="noopener">Materialized Views Examples click here</a></p>
</blockquote>
<h4 id="Indexes"><a href="#Indexes" class="headerlink" title="Indexes"></a>Indexes</h4><blockquote>
<p><code>Indexes</code> are optional structures associated with <code>tables</code> and <code>clusters</code>. You can create many <code>indexes</code> for a <code>table</code> as long as the combination of <code>columns</code> differs for each <code>index</code>. You can create more than one <code>index</code> using the same <code>columns</code> if you specify distinctly different combinations of the <code>columns</code>.</p>
</blockquote>
<blockquote>
<p>Oracle Database provides several indexing schemes, <code>B-tree</code>, <code>Hash cluster</code>, <code>Bitmap</code>, etc., By default, Oracle creates <code>B-tree</code> indexes.</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- syntax</span></span><br><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">UNIQUE</span>] <span class="keyword">INDEX</span> index_name</span><br><span class="line">  <span class="keyword">ON</span> table_name (column1, column2, ... column_n)</span><br><span class="line">  [ <span class="keyword">COMPUTE</span> <span class="keyword">STATISTICS</span> ];</span><br><span class="line"></span><br><span class="line"><span class="comment">-- create a function-based index</span></span><br><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">UNIQUE</span>] <span class="keyword">INDEX</span> index_name</span><br><span class="line">  <span class="keyword">ON</span> table_name (function1, function2, ... function_n)</span><br><span class="line">  [ <span class="keyword">COMPUTE</span> <span class="keyword">STATISTICS</span> ];</span><br><span class="line"></span><br><span class="line"><span class="comment">-- rename index</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">INDEX</span> index_name</span><br><span class="line">  <span class="keyword">RENAME</span> <span class="keyword">TO</span> new_index_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- make index invisible / visible</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">INDEX</span> <span class="keyword">index</span> <span class="keyword">INVISIBLE</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">INDEX</span> <span class="keyword">index</span> <span class="keyword">VISIBLE</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- collect statistics on index</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">INDEX</span> index_name</span><br><span class="line">  <span class="keyword">REBUILD</span> <span class="keyword">COMPUTE</span> <span class="keyword">STATISTICS</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- monitoring index usage - enable / disable</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">INDEX</span> <span class="keyword">index</span> <span class="keyword">MONITORING</span> <span class="keyword">USAGE</span>; <span class="comment">--enable</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">INDEX</span> <span class="keyword">index</span> <span class="keyword">NOMONITORING</span> <span class="keyword">USAGE</span>; <span class="comment">--disable</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- monitoring space use of indexes</span></span><br><span class="line"><span class="keyword">SELECT</span> PCT_USED <span class="keyword">FROM</span> INDEX_STATS <span class="keyword">WHERE</span> <span class="keyword">NAME</span> = <span class="string">'index'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- drop index</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">INDEX</span> index_name;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28318/schema.htm#CNCPT811" target="_blank" rel="noopener">Indexes Overview click here</a><br><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28310/indexes.htm#i1007132" target="_blank" rel="noopener">Indexes Manage click here</a></p>
</blockquote>
<h4 id="Sequence"><a href="#Sequence" class="headerlink" title="Sequence"></a>Sequence</h4><blockquote>
<p><code>Sequences</code> are database objects from which multiple users can generate <strong>unique</strong> integers. The sequence generator generates sequential numbers, which can help to generate <code>unique primary keys</code> automatically, and to coordinate keys across <code>multiple rows</code> or <code>tables</code>.</p>
</blockquote>
<blockquote>
<p>Special attention, <strong>Uses and Restrictions of <code>NEXTVAL</code> and <code>CURRVAL</code></strong></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># cann&apos;t be used in these places:</span><br><span class="line">A subquery</span><br><span class="line">A view query or materialized view query</span><br><span class="line">A SELECT statement with the DISTINCT operator</span><br><span class="line">A SELECT statement with a GROUP BY or ORDER BY clause</span><br><span class="line">A SELECT statement that is combined with another SELECT statement with the UNION, INTERSECT, or MINUS set operator</span><br><span class="line">The WHERE clause of a SELECT statement</span><br><span class="line">DEFAULT value of a column in a CREATE TABLE or ALTER TABLE statement</span><br><span class="line">The condition of a CHECK constraint</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- create syntax - alter same as create, replace CREATE to ALTER</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">SEQUENCE</span> sequence_name</span><br><span class="line">  <span class="keyword">MINVALUE</span> <span class="keyword">value</span></span><br><span class="line">  MAXVALUE <span class="keyword">value</span></span><br><span class="line">  <span class="keyword">START</span> <span class="keyword">WITH</span> <span class="keyword">value</span></span><br><span class="line">  <span class="keyword">INCREMENT</span> <span class="keyword">BY</span> <span class="keyword">value</span></span><br><span class="line">  <span class="keyword">CACHE</span> <span class="keyword">value</span>;</span><br><span class="line"><span class="comment">-- drop</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">SEQUENCE</span> sequence_name;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28318/schema.htm#CNCPT611" target="_blank" rel="noopener">Sequence Overview click here</a><br><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28310/views002.htm#ADMIN11792" target="_blank" rel="noopener">Sequence Manage click here</a></p>
</blockquote>
<h4 id="Synonyms"><a href="#Synonyms" class="headerlink" title="Synonyms"></a>Synonyms</h4><blockquote>
<p>A <code>synonym</code> is an alias for a schema object. Synonyms can provide a level of security by masking the name and owner of an object and by providing location transparency for remote objects of a distributed database. Also, they are convenient to use and reduce the complexity of SQL statements for database users.</p>
</blockquote>
<blockquote>
<p>You can create both <code>public</code> and <code>private</code> synonyms. A <code>public synonym</code> is owned by the special user group named <code>PUBLIC</code> and is accessible to every user in a database. A <code>private synonym</code> is contained in the schema of a specific user and available only to the user and to grantees for the underlying object.</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- I think the sql statement is very clear to express</span></span><br><span class="line"><span class="comment">-- create syntax</span></span><br><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">OR</span> <span class="keyword">REPLACE</span>] [<span class="keyword">PUBLIC</span>] <span class="keyword">SYNONYM</span> [<span class="keyword">schema</span> .] synonym_name</span><br><span class="line">  <span class="keyword">FOR</span> [<span class="keyword">schema</span> .] object_name [@ dblink];</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PUBLIC</span> <span class="keyword">SYNONYM</span> public_emp <span class="keyword">FOR</span> jward.emp</span><br><span class="line"></span><br><span class="line"><span class="comment">-- synonyms in dml statements</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* If you have only the SELECT privilege on the jward.emp table, </span></span><br><span class="line"><span class="comment">* and the synonym jward.employee is created for jward.emp, </span></span><br><span class="line"><span class="comment">* you can query the jward.employee synonym, </span></span><br><span class="line"><span class="comment">* but you cannot insert rows using the jward.employee synonym.</span></span><br><span class="line"><span class="comment">* And if a synonym named employee refers to a table or view,</span></span><br><span class="line"><span class="comment">* then the following statement is valid:</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee (empno, ename, job)</span><br><span class="line">    <span class="keyword">VALUES</span> (emp_sequence.NEXTVAL, <span class="string">'SMITH'</span>, <span class="string">'CLERK'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- drop</span></span><br><span class="line"><span class="keyword">DROP</span> [<span class="keyword">PUBLIC</span>] <span class="keyword">SYNONYM</span> [<span class="keyword">schema</span> .] synonym_name [<span class="keyword">force</span>];</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PUBLIC</span> <span class="keyword">SYNONYM</span> public_emp;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28318/schema.htm#CNCPT711" target="_blank" rel="noopener">Synonyms Overview click here</a><br><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28310/views003.htm#ADMIN11805" target="_blank" rel="noopener">Synonyms Manage click here</a></p>
</blockquote>
<h4 id="Constraints"><a href="#Constraints" class="headerlink" title="Constraints"></a>Constraints</h4><blockquote>
<p>Totally contains <code>PRIMARY KEY CONSTRAINT</code>, <code>UNIQUE CONSTRAINT</code>, <code>FOREIGN KEY CONSTRAINT</code>, <code>NOT NULL CONSTRAINT</code> and <code>CHECK CONSTRAINT</code>, etc.</p>
</blockquote>
<h5 id="PRIMARY-KEY-CONSTRAINT"><a href="#PRIMARY-KEY-CONSTRAINT" class="headerlink" title="PRIMARY KEY CONSTRAINT"></a>PRIMARY KEY CONSTRAINT</h5><blockquote>
<p>A <code>primary</code> key constraint designates a column as the primary key of a table or view. A <strong>composite primary key</strong> designates a combination of columns as the <code>primary</code> key. When you define a primary key constraint inline, you need only the <code>PRIMARY KEY</code> keywords. When you define a primary key constraint out of line, you must also specify one or more columns. You must define a composite primary key out of line.</p>
</blockquote>
<blockquote>
<p>A primary key constraint combines a <code>NOT NULL</code> and <code>UNIQUE</code> constraint in one declaration.</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- syntax</span></span><br><span class="line"><span class="comment">-- create</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line">(</span><br><span class="line">  <span class="keyword">column</span> datatype <span class="literal">null</span>/<span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> constraint_name PRIMARY <span class="keyword">KEY</span> (<span class="keyword">column</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- alter</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> constraint_name PRIMARY <span class="keyword">KEY</span> (column1, column2, ... column_n);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- drop</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> constraint_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- enable / disable</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line"><span class="keyword">ENABLE</span>/<span class="keyword">DISABLE</span> <span class="keyword">CONSTRAINT</span> constraint_name;</span><br></pre></td></tr></table></figure>

<h5 id="UNIQUE-CONSTRAINT"><a href="#UNIQUE-CONSTRAINT" class="headerlink" title="UNIQUE CONSTRAINT"></a>UNIQUE CONSTRAINT</h5><blockquote>
<p>A <code>unique</code> constraint designates a column as a unique key. A <strong>composite unique key</strong> designates a combination of columns as the <code>unique</code> key. When you define a unique constraint inline, you need only the <code>UNIQUE</code> keyword. When you define a unique constraint out of line, you must also specify one or more columns. You must define a composite unique key out of line.</p>
</blockquote>
<blockquote>
<p>To satisfy a unique constraint, no two rows in the table can have the same value for the unique key. However, the unique key made up of a single column can contain nulls. To satisfy a composite unique key, no two rows in the table or view can have the same combination of values in the key columns. Any row that contains nulls in all key columns automatically satisfies the constraint. However, two rows that contain nulls for one or more key columns and the same combination of values for the other key columns violate the constraint.</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- syntax it's same as primary key</span></span><br><span class="line"><span class="comment">-- create</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line">(</span><br><span class="line">  column1 datatype [ <span class="literal">NULL</span> | <span class="keyword">NOT</span> <span class="literal">NULL</span> ],</span><br><span class="line">  column2 datatype [ <span class="literal">NULL</span> | <span class="keyword">NOT</span> <span class="literal">NULL</span> ],</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CONSTRAINT</span> constraint_name <span class="keyword">UNIQUE</span> (uc_col1, uc_col2, ... uc_col_n)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- alter</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> constraint_name <span class="keyword">UNIQUE</span> (column1, column2, ... column_n);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- drop</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> constraint_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- enable / disable</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line"><span class="keyword">ENABLE</span>/<span class="keyword">DISABLE</span> <span class="keyword">CONSTRAINT</span> constraint_name;</span><br></pre></td></tr></table></figure>

<h5 id="FOREIGN-KEY-CONSTRAINT"><a href="#FOREIGN-KEY-CONSTRAINT" class="headerlink" title="FOREIGN KEY CONSTRAINT"></a>FOREIGN KEY CONSTRAINT</h5><blockquote>
<p>A <code>foreign key</code> constraint (also called a referential integrity constraint) designates a column as the foreign key and establishes a relationship between that foreign key and a specified primary or unique key, called the <strong>referenced key</strong>. A <strong>composite foreign key</strong> designates a combination of columns as the foreign key.</p>
</blockquote>
<blockquote>
<p>You can define a foreign key constraint on a single key column either inline or out of line. You must specify a composite foreign key and a foreign key on an attribute out of line.</p>
</blockquote>
<blockquote>
<p>To satisfy a composite foreign key constraint, the composite foreign key must refer to a composite unique key or a composite primary key in the parent table or view, or the value of at least one of the columns of the foreign key must be null.</p>
</blockquote>
<blockquote>
<p><code>Specifc Attention ON DELETE Clause</code><br>The ON DELETE clause lets you determine how Oracle Database automatically maintains referential integrity if you remove a referenced primary or unique key value. If you omit this clause, then Oracle does not allow you to delete referenced key values in the parent table that have dependent rows in the child table.</p>
</blockquote>
<blockquote>
<ul>
<li>Specify <code>CASCADE</code> if you want Oracle to remove dependent foreign key values.</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Specify <code>SET NULL</code> if you want Oracle to convert dependent foreign key values to <code>NULL</code>. You cannot specify this clause for a virtual column, because the values in a virtual column cannot be updated directly. Rather, the values from which the virtual column are derived must be updated.</li>
</ul>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- syntax</span></span><br><span class="line"><span class="comment">-- create</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line">(</span><br><span class="line">  column1 datatype <span class="literal">null</span>/<span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  column2 datatype <span class="literal">null</span>/<span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CONSTRAINT</span> fk_column</span><br><span class="line">    <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (column1, column2, ... column_n)</span><br><span class="line">    <span class="keyword">REFERENCES</span> parent_table (column1, column2, ... column_n)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- alter</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> constraint_name</span><br><span class="line">   <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (column1, column2, ... column_n)</span><br><span class="line">   <span class="keyword">REFERENCES</span> parent_table (column1, column2, ... column_n);</span><br></pre></td></tr></table></figure>

<h5 id="NOT-NULL-CONSTRAINT"><a href="#NOT-NULL-CONSTRAINT" class="headerlink" title="NOT NULL CONSTRAINT"></a>NOT NULL CONSTRAINT</h5><blockquote>
<p>A <code>NOT NULL</code> constraint prohibits a column from containing nulls. The <code>NULL</code> keyword by itself does not actually define an integrity constraint, but you can specify it to explicitly permit a column to contain nulls. You must define <code>NOT NULL</code> and <code>NULL</code> using inline specification. If you specify neither <code>NOT NULL</code> nor <code>NULL</code>, then the default is <code>NULL</code>.<br><code>NOT NULL</code> constraints are the only constraints you can specify inline on <code>XMLType and</code>VARRAY<code>columns.
To satisfy a</code>NOT NULL` constraint, every row in the table must <strong>contain a value</strong> for the column.</p>
</blockquote>
<blockquote>
<ul>
<li>You cannot specify <code>NULL</code> or <code>NOT NULL</code> in a <strong>view</strong> constraint.</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>You cannot specify <code>NULL</code> or <code>NOT NULL</code> for an attribute of an object. Instead, use a <code>CHECK</code> constraint with the <code>IS [NOT] NULL</code> condition.</li>
</ul>
</blockquote>
<h5 id="CHECK-CONSTRAINT"><a href="#CHECK-CONSTRAINT" class="headerlink" title="CHECK CONSTRAINT"></a>CHECK CONSTRAINT</h5><blockquote>
<p>A <code>check</code> constraint lets you specify a condition that each row in the table must <strong>satisfy</strong>. To satisfy the constraint, each row in the table must make the condition either <code>TRUE</code> or unknown (due to a null). When Oracle evaluates a check constraint condition for a particular row, any column names in the condition refer to the column values in that row.</p>
</blockquote>
<blockquote>
<p>The syntax for inline and out-of-line specification of check constraints is the same. However, inline specification can refer only to the column (or the attributes of the column if it is an object column) currently being defined, whereas out-of-line specification can refer to multiple columns or attributes.</p>
</blockquote>
<blockquote>
<p><code>Restrictions on Check Constraints</code></p>
</blockquote>
<blockquote>
<ul>
<li>You cannot specify a <code>check constraint</code> for a <strong>view</strong>. However, you can define the view using the <code>WITH CHECK OPTION</code> clause, which is equivalent to specifying a check constraint for the view.</li>
<li>The condition of a check constraint can refer to any column in the table, but it cannot refer to columns of other tables.</li>
</ul>
</blockquote>
<blockquote>
<p><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28286/clauses002.htm#SQLRF52163" target="_blank" rel="noopener">Constraints Detail click here</a><br><a href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/general005.htm#ADMIN11537" target="_blank" rel="noopener">Constraints Manage click here</a></p>
</blockquote>
<h4 id="Tiggers"><a href="#Tiggers" class="headerlink" title="Tiggers"></a>Tiggers</h4><blockquote>
<p>Database <code>triggers</code> are procedures that are stored in the database and activated (“<strong>fired</strong>“) when specific conditions occur, such as adding a row to a table. You can use triggers to supplement the standard capabilities of the database to provide a highly customized database management system.</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*create trigger statement it can be defined as firing</span></span><br><span class="line"><span class="comment">* BEFORE or AFTER the triggering event, or INSTEAD OF it.</span></span><br><span class="line"><span class="comment">* AFTER / BEFORE [DML] Statements</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">-- create an AFTER DELETE trigger</span></span><br><span class="line"><span class="keyword">CREATE</span> [ <span class="keyword">OR</span> <span class="keyword">REPLACE</span> ] <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line"><span class="keyword">AFTER</span> <span class="keyword">DELETE</span></span><br><span class="line">   <span class="keyword">ON</span> table_name</span><br><span class="line">   [ <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="keyword">ROW</span> ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">   <span class="comment">-- variable declarations</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   <span class="comment">-- trigger code</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXCEPTION</span></span><br><span class="line">   <span class="keyword">WHEN</span> ...</span><br><span class="line">   <span class="comment">-- exception handling</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- trigger enable / disable</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TRIGGER</span> trigger_name <span class="keyword">ENABLE</span>; <span class="comment">--single</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">ENABLE</span> <span class="keyword">ALL</span> <span class="keyword">TRIGGERS</span>; <span class="comment">--all</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TRIGGER</span> trigger_name <span class="keyword">DISABLE</span>; <span class="comment">--single</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">DISABLE</span> <span class="keyword">ALL</span> <span class="keyword">TRIGGERS</span>; <span class="comment">--all</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- drop trigger</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> trigger_name;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28310/general004.htm#ADMIN11534" target="_blank" rel="noopener">Enabling and Disabling Triggers Detail click here</a></p>
</blockquote>
<h4 id="Clusters"><a href="#Clusters" class="headerlink" title="Clusters"></a>Clusters</h4><blockquote>
<p>A <code>cluster</code> provides an optional method of storing table data. A <code>cluster</code> is made up of a group of tables that share the same data blocks. The tables are grouped together because they share common columns and are often used together. </p>
</blockquote>
<blockquote>
<p><code>primary benefits:</code></p>
</blockquote>
<blockquote>
<ul>
<li>Disk I/O is reduced and access time improves for joins of clustered tables.</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>The <code>cluster key</code> is the <strong>column</strong>, or <strong>group of columns</strong>, that the clustered tables have in common. You specify the columns of the cluster key when creating the cluster. You subsequently specify the same columns when creating every table added to the cluster. Each cluster key value is stored only once each in the cluster and the cluster index, no matter how many rows of different tables contain the value.</li>
</ul>
</blockquote>
<blockquote>
<p>And the detail usage will talk about in the later article~<br><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28318/schema.htm#CNCPT608" target="_blank" rel="noopener">Clusters Overview click here</a><br><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28310/clustrs.htm#i1006586" target="_blank" rel="noopener">Clusters Manage click here</a></p>
</blockquote>
<h4 id="Database-links"><a href="#Database-links" class="headerlink" title="Database links"></a>Database links</h4><blockquote>
<p>A <code>database link</code> is a schema object in one database that enables you to access objects on another database. The other database need not be an Oracle Database system. However, to access non-Oracle systems you must use Oracle Heterogeneous Services.</p>
</blockquote>
<blockquote>
<p>By the type, It’s contain <code>private</code>, <code>public</code>, and <code>global</code> database links.</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- create</span></span><br><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">SHARED</span>] [<span class="keyword">PUBLIC</span>] <span class="keyword">DATABASE</span> <span class="keyword">LINK</span> &lt;link_name&gt;</span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">TO</span> <span class="keyword">CURRENT_USER</span></span><br><span class="line"><span class="keyword">USING</span> <span class="string">'&lt;service_name&gt;'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- create tnsnames entry for conn_link</span></span><br><span class="line">conn_link =</span><br><span class="line">  (DESCRIPTION =</span><br><span class="line">    (ADDRESS_LIST =</span><br><span class="line">      (ADDRESS = (PROTOCOL = TCP)(HOST = perrito2)(PORT = 1521))</span><br><span class="line">    )</span><br><span class="line">    (CONNECT_DATA =</span><br><span class="line">      (SERVICE_NAME = orabase)</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">conn uwclass/uwclass</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="keyword">LINK</span> conn_user</span><br><span class="line"><span class="keyword">USING</span> <span class="string">'conn_link'</span>;</span><br><span class="line"></span><br><span class="line">desc user_db_links</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> linesize <span class="number">121</span></span><br><span class="line"><span class="keyword">col</span> db_link <span class="keyword">format</span> a20</span><br><span class="line"><span class="keyword">col</span> username <span class="keyword">format</span> a20</span><br><span class="line"><span class="keyword">col</span> <span class="keyword">password</span> <span class="keyword">format</span> a20</span><br><span class="line"><span class="keyword">col</span> host <span class="keyword">format</span> a20</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> user_db_links;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> all_db_links;</span><br><span class="line"><span class="keyword">SELECT</span> table_name, tablespace_name <span class="keyword">FROM</span> user_tables@conn_user;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- close db link</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SESSION</span> <span class="keyword">CLOSE</span> <span class="keyword">DATABASE</span> <span class="keyword">LINK</span> &lt;link_name&gt;;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SESSION</span> <span class="keyword">CLOSE</span> <span class="keyword">DATABASE</span> <span class="keyword">LINK</span> curr_user;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- drop db link</span></span><br><span class="line"><span class="keyword">DROP</span> [<span class="keyword">PUBLIC</span>] <span class="keyword">DATABASE</span> <span class="keyword">LINK</span> &lt;link_name&gt;;</span><br><span class="line"><span class="keyword">DROP</span> [<span class="keyword">PUBLIC</span>] <span class="keyword">DATABASE</span> <span class="keyword">LINK</span> test_link;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- test db link</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">ALTER</span> <span class="keyword">SESSION</span> <span class="keyword">CLOSE</span> <span class="keyword">DATABASE</span> <span class="keyword">LINK</span> remove_db;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SELECT</span> table_name</span><br><span class="line">  <span class="keyword">INTO</span> i</span><br><span class="line">  <span class="keyword">FROM</span> all_tables@remote_db</span><br><span class="line">  <span class="keyword">WHERE</span> <span class="keyword">rownum</span> = <span class="number">1</span>;</span><br><span class="line">EXCEPTION</span><br><span class="line">  WHEN OTHERS THEN</span><br><span class="line">    RAISE_APPLICATION_ERROR(-20999, 'No Connection');</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28310/ds_concepts002.htm#ADMIN12083" target="_blank" rel="noopener">Database links Overview click here</a><br><a href="http://psoug.org/reference/db_link.html" target="_blank" rel="noopener">Database link pl/sql</a></p>
</blockquote>
<h3 id="Database-logs"><a href="#Database-logs" class="headerlink" title="Database logs"></a>Database logs</h3><h4 id="Redo-logs"><a href="#Redo-logs" class="headerlink" title="Redo logs"></a>Redo logs</h4><blockquote>
<p><code>Redo logs</code> contain a record of changes that were made to datafiles. Redo logs are stored in redo log groups, and you must have <strong>at least two redo log groups</strong> for your database. After the redo log files in a group have filled up, the log writer process (<code>LGWR</code>) switches the writing of redo records to a new redo log group.</p>
</blockquote>
<blockquote>
<p>And specific point:</p>
<ul>
<li>Record of how to reproduce a change</li>
<li>Used for Rolling forward database changes</li>
<li>Stored in redo log files</li>
<li>Protect against data loss.</li>
</ul>
</blockquote>
<h5 id="How-to-detect"><a href="#How-to-detect" class="headerlink" title="How to detect"></a>How to detect</h5><blockquote>
<p>To find sessions generating lots of redo, you can use either of the following methods. Both methods examine the amount of undo generated. When a transaction generates undo, it will automatically generate redo as well. </p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* Query V$SESS_IO. </span></span><br><span class="line"><span class="comment">* This view contains the column BLOCK_CHANGES which indicates </span></span><br><span class="line"><span class="comment">* how much blocks have been changed by the session. </span></span><br><span class="line"><span class="comment">* High values indicate a session generating lots of redo.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">SELECT</span> s.sid, s.serial<span class="comment">#, s.username, s.program, i.block_changes</span></span><br><span class="line"><span class="keyword">FROM</span> v$<span class="keyword">session</span> s, v$sess_io i</span><br><span class="line"><span class="keyword">WHERE</span> s.sid = i.sid</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">5</span> <span class="keyword">desc</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* Query V$TRANSACTION.</span></span><br><span class="line"><span class="comment">* These view contains information about the amount of undo blocks </span></span><br><span class="line"><span class="comment">* and undo records accessed by the transaction </span></span><br><span class="line"><span class="comment">* (as found in the USED_UBLK and USED_UREC columns).</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">SELECT</span> s.sid, s.serial<span class="comment">#, s.username, s.program, t.used_ublk, t.used_urec</span></span><br><span class="line"><span class="keyword">FROM</span> v$<span class="keyword">session</span> s, v$<span class="keyword">transaction</span> t</span><br><span class="line"><span class="keyword">WHERE</span> s.taddr = t.addr</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">5</span> <span class="keyword">desc</span>, <span class="number">6</span> <span class="keyword">desc</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>;</span><br></pre></td></tr></table></figure>

<h4 id="Archive-logs"><a href="#Archive-logs" class="headerlink" title="Archive logs"></a>Archive logs</h4><blockquote>
<p>Oracle Database can automatically save the inactive group of redo log files to one or more offline destinations, known collectively as the <code>archived redo log</code> (also called the <strong>archive log</strong>). The process of turning redo log files into archived redo log files is called <strong>archiving</strong>.</p>
</blockquote>
<h5 id="How-to-detect-archive-mode"><a href="#How-to-detect-archive-mode" class="headerlink" title="How to detect archive mode:"></a>How to detect archive mode:</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">sqlplus / as sysdba</span><br><span class="line">SQL&gt; archive <span class="built_in">log</span> list</span><br><span class="line">Database <span class="built_in">log</span> mode              No Archive Mode</span><br><span class="line">Automatic archival             Disabled</span><br><span class="line">Archive destination            USE_DB_RECOVERY_FILE_DEST</span><br><span class="line">Oldest online <span class="built_in">log</span> sequence     25</span><br><span class="line">Current <span class="built_in">log</span> sequence           27</span><br><span class="line"></span><br><span class="line">SQL&gt; show parameter recovery_file_dest</span><br><span class="line">NAME                                 TYPE        VALUE</span><br><span class="line">------------------------------------ ----------- ------------------------------</span><br><span class="line">db_recovery_file_dest                string      /u01/app/oracle/flash_recovery</span><br><span class="line">                                                 _area</span><br><span class="line">db_recovery_file_dest_size           big <span class="built_in">integer</span> 3852M</span><br></pre></td></tr></table></figure>

<h5 id="How-to-enable-disable-archive"><a href="#How-to-enable-disable-archive" class="headerlink" title="How to enable / disable archive"></a>How to enable / disable archive</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># first shutdown database</span></span><br><span class="line">SQL&gt; shutdown immediate</span><br><span class="line"><span class="comment"># then startup mount</span></span><br><span class="line">SQL&gt; startup mount</span><br><span class="line"><span class="comment"># alter database archive mode</span></span><br><span class="line">SQL&gt; alter database archivelog;</span><br><span class="line">SQL&gt; alter database open;</span><br><span class="line">SQL&gt; archive <span class="built_in">log</span> list</span><br><span class="line">Database <span class="built_in">log</span> mode              Archive Mode</span><br><span class="line">Automatic archival             Enabled</span><br><span class="line">Archive destination            /u02/app/oracle/oradata/orcl/arch</span><br><span class="line">Oldest online <span class="built_in">log</span> sequence     25</span><br><span class="line">Next <span class="built_in">log</span> sequence to archive   27</span><br><span class="line">Current <span class="built_in">log</span> sequence           27</span><br><span class="line"><span class="comment"># switch log file location</span></span><br><span class="line">SQL&gt; alter system switch logfile;</span><br><span class="line">SQL&gt; host </span><br><span class="line">$ ls /u02/app/oracle/oradata/orcl/arch</span><br><span class="line"></span><br><span class="line"><span class="comment"># disable archive is almost same as enable</span></span><br><span class="line"><span class="comment"># just change this one:</span></span><br><span class="line">SQL&gt; alter database noarchivelog;</span><br></pre></td></tr></table></figure>

<h4 id="Undo-logs"><a href="#Undo-logs" class="headerlink" title="Undo logs"></a>Undo logs</h4><blockquote>
<p><code>Undo tablespaces</code> are special tablespaces used solely for storing undo information.<br>You cannot create any other <code>segment types</code> (for example, <code>tables or indexes</code>) in <code>undo tablespaces</code>. Each database contains <strong>zero or more</strong> undo tablespaces. In automatic undo management mode, each Oracle instance is assigned <strong>one (and only one)</strong> undo tablespace.<br>Undo data is managed within an undo tablespace using undo segments that are automatically created and maintained by Oracle.</p>
</blockquote>
<blockquote>
<p>And undo records are used to：</p>
<ul>
<li>Roll back transactions when a ROLLBACK statement is issued</li>
<li>Recover the database</li>
<li>Provide read consistency</li>
<li>Analyze data as of an earlier point in time by using Oracle Flashback Query</li>
<li>Recover from logical corruptions using Oracle Flashback features </li>
</ul>
</blockquote>
<blockquote>
<p>but, It’s different with redo:</p>
<ul>
<li>Record of how to undo a change.</li>
<li>Used for Rollback, read-consistency</li>
<li>Stored in Undo Segments</li>
<li>Protect against inconsistent reads in multiuser systems</li>
</ul>
</blockquote>
<h5 id="How-to-detect-1"><a href="#How-to-detect-1" class="headerlink" title="How to detect"></a>How to detect</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* V$TRANSACTION linked with V$SESSION will show current used undo blocks for ongoing transactions.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">SELECT</span> a.sid, a.username, b.used_urec, b.used_ublk</span><br><span class="line"><span class="keyword">FROM</span> v$<span class="keyword">session</span> a, v$<span class="keyword">transaction</span> b</span><br><span class="line"><span class="keyword">WHERE</span> a.saddr = b.ses_addr</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> b.used_ublk <span class="keyword">DESC</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* V$SESSTAT provides another view, which uses the undo kind of view, </span></span><br><span class="line"><span class="comment">* but we must avoid getting lost in the maze of Oracle statistics and focusing on just one: </span></span><br><span class="line"><span class="comment">* Undo change vector size, which will accumulate the bytes of undo used during the session lifetime.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> a.sid, b.name, a.value</span><br><span class="line"><span class="keyword">FROM</span> v$sesstat a, v$statname b</span><br><span class="line"><span class="keyword">WHERE</span> a.statistic<span class="comment"># = b.statistic#</span></span><br><span class="line"><span class="keyword">AND</span> a.statistic<span class="comment"># = 176&lt;– Which stands for undo change vector size</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> a.value <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure>

<h4 id="Logs-and-Directories"><a href="#Logs-and-Directories" class="headerlink" title="Logs and Directories"></a>Logs and Directories</h4><h5 id="How-to-detect-log-in-sql-statement"><a href="#How-to-detect-log-in-sql-statement" class="headerlink" title="How to detect log in sql statement"></a>How to detect log in sql statement</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Displays all redo log groups for the database and indicates which need to be archived.</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">GROUP</span><span class="comment">#, THREAD#, SEQUENCE#, MEMBERS, ARCHIVED, STATUS FROM SYS.V$LOG;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- Shows if the database is in ARCHIVELOG or NOARCHIVELOG mode </span></span><br><span class="line"><span class="comment">-- and if MANUAL (archiving mode) has been specified.</span></span><br><span class="line"><span class="keyword">SELECT</span> LOG_MODE <span class="keyword">FROM</span> SYS.V$<span class="keyword">DATABASE</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Displays information about the state of the various archive processes for an instance.</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> SYS.V$ARCHIVE_PROCESSES;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Displays historical archived log information from the control file. </span></span><br><span class="line"><span class="comment">-- If you use a recovery catalog, the RC_ARCHIVED_LOG view contains similar information.</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> SYS.V$ARCHIVED_LOG;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Describes the current instance, all archive destinations, </span></span><br><span class="line"><span class="comment">-- and the current value, mode, and status of these destinations.</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> SYS.V$ARCHIVE_DEST;</span><br></pre></td></tr></table></figure>

<h5 id="How-to-list-oracle-directories"><a href="#How-to-list-oracle-directories" class="headerlink" title="How to list oracle directories"></a>How to list oracle directories</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- list all directories in the database.</span></span><br><span class="line"><span class="keyword">select</span> owner, directory_name, directory_path <span class="keyword">from</span> dba_directories;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- list logfiles member</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">member</span> <span class="keyword">from</span> v$<span class="keyword">logfile</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Resources:<br><a href="http://psoug.org/index.htm" target="_blank" rel="noopener">http://psoug.org/index.htm</a><br><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28318/physical.htm" target="_blank" rel="noopener">https://docs.oracle.com/cd/B28359_01/server.111/b28318/physical.htm</a><br><a href="http://database.51cto.com/art/200910/158936.htm" target="_blank" rel="noopener">http://database.51cto.com/art/200910/158936.htm</a><br><a href="https://docs.oracle.com/cd/B28359_01/server.111/b28318/logical.htm" target="_blank" rel="noopener">https://docs.oracle.com/cd/B28359_01/server.111/b28318/logical.htm</a><br><a href="http://www.jianshu.com/p/4d388f148737" target="_blank" rel="noopener">http://www.jianshu.com/p/4d388f148737</a><br><a href="https://oraclenz.wordpress.com/2008/06/22/differences-between-undo-and-redo/" target="_blank" rel="noopener">https://oraclenz.wordpress.com/2008/06/22/differences-between-undo-and-redo/</a></p>
</blockquote>

      </div>
      <div class="post-copyright">
    <p class="copyright-item">
      <span>Author: </span>
      <a href="https://ebanbox.com">itabas016</a>
    </p>
    <p class="copyright-item">
      <span>Link: </span>
      <a href="https://ebanbox.com/2016/10/14/database/oracle-kt-database-structure/">https://ebanbox.com/2016/10/14/database/oracle-kt-database-structure/</a>
    </p>
    <p class="copyright-item">
      <span>License: </span><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank"><strong>CC BY-NC-ND 4.0</strong></a>
    </p>
  </div>
      <div class="post-reward">
    <input type="checkbox" name="reward" id="reward" hidden>
    <label class="reward-button" for="reward">Reward</label>
    <div class="qr-code"><label class="qr-code-image" for="reward">
          <img class="image" src="/images/collect_qrcode_1505745819720.jpg" title="wechat">
        </label>
      </div>
  </div><footer class="post-footer">
        <div class="post-tags">
            <a href="/tags/Oracle/">Oracle</a>
            <a href="/tags/KT/">KT</a>
            </div>
        
        <nav class="post-nav"><a class="prev" href="/2016/10/14/database/oracle-kt-asm/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Oracle - ASM(Automatic Storage Management)</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    <a class="next" href="/2016/10/13/database/oracle-kt-how-to-read-a-query-plan/">
        <span class="next-text nav-default">Oracle - How to Read a Query Plan</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></footer>
    </article></div><div class="comments" id="comments"><div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:me@itabas.com" class="iconfont icon-email" title="email"></a>
        <a href="https://www.twitter.com/itabas16" class="iconfont icon-twitter" title="twitter"></a>
        <a href="https://www.facebook.com/itabas16" class="iconfont icon-facebook" title="facebook"></a>
        <a href="https://github.com/itabas016" class="iconfont icon-github" title="github"></a>
        <a href="http://weibo.com/struthio" class="iconfont icon-weibo" title="weibo"></a>
        <a href="https://www.instagram.com/itabas016/" class="iconfont icon-instagram" title="instagram"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">&copy;2016 - 2020<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">itabas016</span>
  </span>
  <span class="icp">
    <a class="icp-link" href="http://www.beian.miit.gov.cn/">鲁ICP备19063268号-1</a>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'https://ebanbox.com/2016/10/14/database/oracle-kt-database-structure/';
        this.page.identifier = '2016/10/14/database/oracle-kt-database-structure/';
        this.page.title = 'Oracle - Database Structure';
    };
    (function() {
    var d = document, s = d.createElement('script');

    s.src = '//itabas016.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();  
  </script><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
</body>
</html>
